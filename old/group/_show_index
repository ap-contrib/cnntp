<%shared>
use MIME::WordDecoder;
</%shared>
<%perl>
  my $o_fmt = $m->comp("_overview_format", nntp => $nntp);
 
  my $max = $group_info[2];
  if ($args{max} > $max) {
    $m->comp('/redirect', url => "/group/". $group);
  }
  $max = $args{max} if $args{max} > 0;

  #$m->flush_buffer;

  my $articles_per_list = 100;
  my $min = $max > $articles_per_list ? $max - $articles_per_list : 1;

  $m->flush_buffer;

  my $new_max = ($max + $articles_per_list+1 < $group_info[2]) ? ";max=".($max+$articles_per_list+1) : "";
  my @nav = (
    ["Previous", ";max=".($min-1), sub { $min > 1 } ],
    ["Next",     $new_max,         sub { $max < $group_info[2] } ],
    ["Latest",   "",               sub { $max < $group_info[2] } ],
  );
  my $index_navigation = join " | ",
	map { &{$_->[2]} 
               ? qq[<a href="/group/$group$_->[1]">$_->[0]</a>] 
               : $_->[0]
            } @nav;

</%perl>

%  my $xover = $nntp->xover([$min, $max]);
<a href="/group/">Back to group listing</a> | <a href="news://nntp.perl.org/<% $group %>">read in news reader</a> | <a href="/rss/<%$group%>.rdf">rss</A><br>
<% $group_info[0] %> articles, listing <% $max %>-<% $min %><br>
<% $index_navigation %>
<p>

<table>
<tr>
<td>#</td><td>Subject</td>
<td>Author</td><td>Date</td><td>Lin</td>

</tr>

% my $i = 0;
% for my $num (reverse $min..$max) {
<tr>
<td class="list"><a href="/group/<% $group %>/<% $num %>"><% $num %></a> </td>
% for my $field (qw(Subject From Date Lines)) {
%   my $s = $xover->{$num}->[$o_fmt->{$field}];
%   $s = unmime($s);
%   $s=~s/ .*//, $s =~ s/\@/#/ if $field eq "From";
%   $s = Apache::Util::escape_html($s);
%   #$s =~ s/[+-].*// if $field eq "Date";
<td class="list"><% $s %></td>
%   unless (++$i % 25) {
%     $m->flush_buffer;
%   }
% }
%#   my $header = $nntp->head($num);

%# <% $header->[0] %><br>

</tr>
% }
</table>

<br>

<% $index_navigation %>


<%args>
  $nntp
  $group
  @group_info
  %args
</%args>
